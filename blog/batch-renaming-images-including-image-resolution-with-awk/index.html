<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Victoria Drake, Director of Engineering, is building better cybersecurity and happy and productive technical teams."><title>Batch renaming images, including image resolution, with awk | victoria.dev</title><link href=https://github.com/victoriadrake rel=me><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=webmention href=https://webmention.io/victoria.dev/webmention><link rel=pingback href=https://webmention.io/victoria.dev/xmlrpc><link rel=feed href=https://victoria.dev/neofeed><script async defer data-domain=victoria.dev src=https://p.victoria.dev/js/index.js></script><meta name=monetization content="$ilp.uphold.com/pBRfRwg2EJAe"><meta property="og:title" content="Batch renaming images, including image resolution, with awk - victoria.dev"><meta property="og:type" content="website"><meta property="og:description" content="How to batch rename images with custom values using file, awk, and rename - in rainbow colors!"><meta property="og:url" content="https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/"><meta property="og:site_name" content="victoria.dev"><meta property="og:image" content="https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/renaming-rainbow.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Batch renaming images, including image resolution, with awk"><meta name=twitter:image content="https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/renaming-rainbow.png"><meta name=twitter:description content="How to batch rename images with custom values using file, awk, and rename - in rainbow colors!"><link rel="shortcut icon" href=/img/favicon.ico><link rel=stylesheet href=/css/main.min.71bda43b94faa51c2d4670e14068d356b86bf875213c6fc5e9a199ab2a57d1de.css integrity="sha256-cb2kO5T6pRwtRnDhQGjTVrhr+HUhPG/F6aGZqypX0d4=" media=screen></head><body><header role=banner><nav aria-label="Victoria.dev main menu" id=menu><ul role=menubar><li role=none class=menu-item><a role=menuitem href=/><img src=/img/bookmark.svg alt="home page icon" height=18px class=filter-icon> hi</a></li><li role=none class=menu-item><a role=menuitem href=/blog/><img src=/img/quote.svg alt="blog icon" height=18px class=filter-icon> blog</a></li><li role=none class=menu-item><a role=menuitem href=/about/><img src=/img/profile.svg alt="about page icon" height=18px class=filter-icon> about</a></li><li role=none class=menu-item><a role=menuitem href=/coffee/><img src=/img/coffee.svg alt="coffee icon" height=18px class=filter-icon> buy me coffee</a></li><li role=none class=menu-item><a role=menuitem href=/bookshelf/><img src=/img/book.svg alt="bookshelf icon" height=18px class=filter-icon> bookshelf</a></li><li role=none class=menu-item><a role=menuitem id=rss href=https://victoria.dev/index.xml rel=alternate type=application/rss+xml title="RSS for Batch renaming images, including image resolution, with awk"><img src=/img/rss.svg alt="RSS icon" height=18px class=filter-icon> rss</a></li></ul></nav></header><main aria-role=main><div class=container><article class=h-entry><h1 class=title-header>Batch renaming images, including image resolution, with awk</h1><p class=subtitle>How to batch rename images with custom values using file, awk, and rename - in rainbow colors!</p><span><a class="tag button" href=/tags/terminal/>terminal
</a>&nbsp;
<a class="tag button" href=/tags/linux/>linux
</a>&nbsp;
<a class="tag button" href=/tags/ci/cd/>ci/cd
</a>&nbsp;</span><p class=metadata id=date><time><a class="u-url dt-published" href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/>November 20, 2017</a></time>
<span class=dt-updated>&nbsp;
<em>Updated: Mar 16, 2021</em></span>
<span>☕️&nbsp;4 min read</span></p></p><div class=page-separator><hr></div><div class="markdown e-content"><p>The most recent item on my list of &ldquo;Geeky things I did that made me feel pretty awesome&rdquo; is an hour&rsquo;s adventure that culminated in this code:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ file IMG* <span class=p>|</span> awk <span class=s1>&#39;BEGIN{a=0} {print substr($1, 1, length($1)-5),a++&#34;_&#34;substr($8,1, length($8)-1)}&#39;</span> <span class=p>|</span> <span class=k>while</span> <span class=nb>read</span> fn fr<span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=k>$(</span>rename -v <span class=s2>&#34;s/</span><span class=nv>$fn</span><span class=s2>/img_</span><span class=nv>$fr</span><span class=s2>/g&#34;</span> *<span class=k>)</span><span class=p>;</span> <span class=k>done</span>
IMG_20170808_172653_425.jpg renamed as img_0_4032x3024.jpg
IMG_20170808_173020_267.jpg renamed as img_1_3024x3506.jpg
IMG_20170808_173130_616.jpg renamed as img_2_3024x3779.jpg
IMG_20170808_173221_425.jpg renamed as img_3_3024x3780.jpg
IMG_20170808_173417_059.jpg renamed as img_4_2956x2980.jpg
IMG_20170808_173450_971.jpg renamed as img_5_3024x3024.jpg
IMG_20170808_173536_034.jpg renamed as img_6_4032x3024.jpg
IMG_20170808_173602_732.jpg renamed as img_7_1617x1617.jpg
IMG_20170808_173645_339.jpg renamed as img_8_3024x3780.jpg
IMG_20170909_170146_585.jpg renamed as img_9_3036x3036.jpg
IMG_20170911_211522_543.jpg renamed as img_10_3036x3036.jpg
IMG_20170913_071608_288.jpg renamed as img_11_2760x2760.jpg
IMG_20170913_073205_522.jpg renamed as img_12_2738x2738.jpg
// ... etc etc
</code></pre></div><p>The last item on the aforementioned list is &ldquo;TODO: come up with a shorter title for this list.&rdquo;</p><p>I previously wrote about the power of command line tools like <a href=/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/>sed</a>. This post expands on how to string all this magical functionality into one big, long, rainbow-coloured, viscous stream of awesome.</p><h2 id=rename-files class=anchor-link><a href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/#rename-files>Rename files</a></h2><p>The tool that actually handles the renaming of our files is, appropriately enough, <code>rename</code>. The syntax is: <code>rename -n "s/original_filename/new_filename/g" *</code> where <code>-n</code> does a dry-run, and substituting <code>-v</code> would rename the files. The <code>s</code> indicates our substitution string, and <code>g</code> for &ldquo;global&rdquo; finds all occurrences of the string. The <code>*</code> matches zero or more occurrences of our search-and-replace parameters.</p><p>We&rsquo;ll come back to this later.</p><h2 id=get-file-information class=anchor-link><a href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/#get-file-information>Get file information</a></h2><p>When I run <code>$ file IMG_20170808_172653_425.jpg</code> in the image directory, I get this output:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>IMG_20170808_172653_425.jpg: JPEG image data, baseline, precision 8, 4032x3024, frames <span class=m>3</span>
</code></pre></div><p>Since we can get the image resolution (&ldquo;4032x3024&rdquo; above), we know that we&rsquo;ll be able to use it in our new filename.</p><h2 id=isolate-the-information-we-want class=anchor-link><a href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/#isolate-the-information-we-want>Isolate the information we want</a></h2><p>I love <code>awk</code> for its simplicity. It takes lines of text and makes individual bits of information available to us with built in variables that we can then refer to as column numbers denoted by <code>$1</code>, <code>$2</code>, etc. By default, <code>awk</code> splits up columns on whitespace. To take the example above:</p><div class=highlight><pre class=chroma><code class=language-text data-lang=text>|              1               |   2  |   3   |   4   |     5     |     6     | 7  |      8     |   9    | 10 |
-------------------------------------------------------------------------------------------------------------
| IMG_20170808_172653_425.jpg: | JPEG | image | data, | baseline, | precision | 8, | 4032x3024, | frames | 3  |
</code></pre></div><p>We can denote different values to use as a splitter with, for example, <code>-F','</code> if we wanted to use commas as the column divisions. For our current project, spaces are fine.</p><p>There are a couple issues we need to solve before we can plug the information into our new filenames. Column <code>$1</code> has the original filename we want, but there&rsquo;s an extra &ldquo;:&rdquo; character on the end. We don&rsquo;t need the &ldquo;.jpg&rdquo; either. Column <code>$8</code> has an extra &ldquo;,&rdquo; that we don&rsquo;t want as well. To get just to information we need, we&rsquo;ll take a substring of the column with <code>substr()</code>:</p><p><code>substr($1, 1, length($1)-5)</code> - This gives us the file name from the beginning of the string to the end of the string, minus 5 characters (&ldquo;length minus 5&rdquo;).
<code>substr($8,1, length($8)-1)</code> - This gives us the image size, without the extra comma (&ldquo;length minus 1&rdquo;).</p><h2 id=avoid-duplicate-file-names class=anchor-link><a href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/#avoid-duplicate-file-names>Avoid duplicate file names</a></h2><p>To ensure that two images with the same resolutions don&rsquo;t create identical, competing file names, we&rsquo;ll append a unique incrementing number to the filename.</p><p><code>BEGIN{a=0}</code> - Using <code>BEGIN</code> tells <code>awk</code> to run the following code only once, at the (drumroll) beginning. Here, we&rsquo;re declaring the variable <code>a</code> to be <code>0</code>.
<code>a++</code> - Later in our code, at the appropriate spot for our file name, we call <code>a</code> and increment it.</p><p>When <code>awk</code> prints a string, it concatenates everything that isn&rsquo;t separated by a comma. <code>{print a b c}</code> would create &ldquo;abc&rdquo; and <code>{print a,b,c}</code> would create &ldquo;a b c&rdquo;, for example.</p><p>We can add additional characters to our file name, such as an underscore, by inserting it in quotations: <code>"_"</code>.</p><h2 id=string-it-all-together class=anchor-link><a href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/#string-it-all-together>String it all together</a></h2><p>To feed the output of one command into another command, we use &ldquo;pipe,&rdquo; written as <code>|</code>.</p><p>If we only used pipe in this instance, all our data from <code>file</code> and <code>awk</code> would get fed into <code>rename</code> all at once, making for one very, very long and probably non-compiling file name. To run the <code>rename</code> command line by line, we can use <code>while</code> and <code>read</code>. Similarly to <code>awk</code>, <code>read</code> takes input and splits it into variables we can assign and use. In our code, it takes the first bit of output from <code>awk</code> (the original file name) and assigns that the variable name <code>$fn</code>. It takes the second output (our incrementing number and the image resolution) and assigns that to <code>$fr</code>. The variable names are arbitrary; you can call them whatever you want.</p><p>To run our <code>rename</code> commands as if we&rsquo;d manually entered them in the terminal one by one, we can use <code>echo $(some command)</code>. Finally, <code>done</code> ends our <code>while</code> loop.</p><h2 id=bonus-round-rainbow-output class=anchor-link><a href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/#bonus-round-rainbow-output>Bonus round: rainbow output</a></h2><p>I wasn&rsquo;t kidding with that <a href=https://github.com/tehmaze/lolcat>&ldquo;rainbow-coloured&rdquo; bit&mldr;</a></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>p install lolcat
</code></pre></div><p>Here&rsquo;s our full code:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>le IMG* <span class=p>|</span> awk <span class=s1>&#39;BEGIN{a=0} {print substr($1, 1, length($1)-5),a++&#34;_&#34;substr($8,1, length($8)-1)}&#39;</span> <span class=p>|</span> <span class=k>while</span> <span class=nb>read</span> fn fs<span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=k>$(</span>rename -v <span class=s2>&#34;s/</span><span class=nv>$fn</span><span class=s2>/img_</span><span class=nv>$fs</span><span class=s2>/g&#34;</span> *<span class=k>)</span><span class=p>;</span> <span class=k>done</span> <span class=p>|</span> lolcat
</code></pre></div><p>Enjoy!</p></div><a class=hidden href=https://brid.gy/publish/twitter></a><a class=hidden href=https://brid.gy/publish/mastodon></a><data class=p-bridgy-omit-link value=false></data></article><div id=up-container><a href=# id=up>&#709;</a></div><div class=page-separator><hr></div><div id=webmentions></div><div class=related><code class=language-sql data-lang=sql>SELECT TOP 3 * FROM Related;</code><ul role=menubar id=article-list><li role=none class=h-entry><p class="p-author h-card hidden">Victoria Drake</p><img class="u-photo hidden" alt="photo of the author" id=author-img src=/img/victoria_headshot.jpg>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/>A portable Makefile for continuous delivery with Hugo and GitHub Pages</a><p class=e-content>My Makefile for building this site, optimizing images, and running my CI/CD GitHub Actions flow.</p><p class=metadata><a class="tag button" href=/tags/ci/cd/>ci/cd</a>
☕️
&nbsp;5 min read
<time class="hidden dt-published">2019-10-21 09:09:06 -0400 -0400</time></p></li><li role=none class=h-entry><p class="p-author h-card hidden">Victoria Drake</p><img class="u-photo hidden" alt="photo of the author" id=author-img src=/img/victoria_headshot.jpg>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/>How I created custom desktop notifications using terminal and cron</a><p class=e-content>How you can use tools your Linux system already has to create custom desktop notifications.</p><p class=metadata><a class="tag button" href=/tags/terminal/>terminal</a>
☕️ ☕️
&nbsp;6 min read
<time class="hidden dt-published">2017-02-21 10:48:38 +0700 +0700</time></p></li><li role=none class=h-entry><p class="p-author h-card hidden">Victoria Drake</p><img class="u-photo hidden" alt="photo of the author" id=author-img src=/img/victoria_headshot.jpg>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/create-a-self-hosted-chat-service-with-your-own-matrix-server/>Create a self-hosted chat service with your own Matrix server</a><p class=e-content>A speed-run introduction to Matrix via Dendrite.</p><p class=metadata><a class="tag button" href=/tags/privacy/>privacy</a>
☕️ ☕️
&nbsp;6 min read
<time class="hidden dt-published">2021-02-15 01:38:07 -0500 -0500</time></p></li></ul><div class=page-separator><p class=back-link><a href=/blog>&lt;&lt; Back to blog</a></p></div></div></div><footer class=container><div class="markdown bio h-card p-author"><strong><a href=https://victoria.dev/ class="u-url p-name">Victoria Drake</a></strong><figure class="profile title-avatar u-photo"><img src=/img/victoria_headshot.jpg alt="Victoria's headshot"></figure><p>Victoria Drake is a Director of Engineering in Washington, DC. She is a core maintainer and co-author for the Open Web Application Security Project (OWASP) Web Security Testing Guide. She earned the annual Top Contributor award three years in a row from the freeCodeCamp non-profit, and is a recognized Distinguished Author on the DEV.to developer platform. She writes about software development, cybersecurity, and building happy and productive technical teams.</p><p><a href=/about>about</a> - <a href=mailto:hello@victoria.dev>email</a> - <a href=https://github.com/victoriadrake>github</a> - <a href=https://twitter.com/victoriadotdev>twitter</a> - <a href=https://www.linkedin.com/in/victoriadotdev/>linkedin</a></p></div></footer></main><script src=/js/webmention.min.js data-wordcount=42 async></script><nav aria-label="Victoria.dev menu for mobile" id=menu-mobile><ul role=menubar><li role=none class=menu-item><a role=menuitem href=/><img src=/img/bookmark.svg alt="home page icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/blog/><img src=/img/quote.svg alt="blog icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/about/><img src=/img/profile.svg alt="about page icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/coffee/><img src=/img/coffee.svg alt="coffee icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/bookshelf/><img src=/img/book.svg alt="bookshelf icon" height=18px class=filter-icon></a></li></ul></nav></body></html>