<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Victoria Drake, Director of Engineering, is building better cybersecurity and happy and productive technical teams."><title>How I created custom desktop notifications using terminal and cron | victoria.dev</title><link href=https://github.com/victoriadrake rel=me><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=webmention href=https://webmention.io/victoria.dev/webmention><link rel=pingback href=https://webmention.io/victoria.dev/xmlrpc><link rel=feed href=https://victoria.dev/neofeed><script async defer data-domain=victoria.dev src=https://p.victoria.dev/js/index.js></script><meta name=monetization content="$ilp.uphold.com/pBRfRwg2EJAe"><meta property="og:title" content="How I created custom desktop notifications using terminal and cron - victoria.dev"><meta property="og:type" content="website"><meta property="og:description" content="How you can use tools your Linux system already has to create custom desktop notifications."><meta property="og:url" content="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/"><meta property="og:site_name" content="victoria.dev"><meta property="og:image" content="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="How I created custom desktop notifications using terminal and cron"><meta name=twitter:image content="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif.png"><meta name=twitter:description content="How you can use tools your Linux system already has to create custom desktop notifications."><link rel="shortcut icon" href=/img/favicon.ico><link rel=stylesheet href=/css/main.min.4c13cca18828b7ff25325d6765a13a7804155171679a73a19390bb401cea9c1c.css integrity="sha256-TBPMoYgot/8lMl1nZaE6eAQVUXFnmnOhk5C7QBzqnBw=" media=screen></head><body><header role=banner><nav aria-label="Victoria.dev main menu" id=menu><ul role=menubar><li role=none class=menu-item><a role=menuitem href=/><img src=/img/bookmark.svg alt="home page icon" height=18px class=filter-icon> hi</a></li><li role=none class=menu-item><a role=menuitem href=/blog/><img src=/img/quote.svg alt="blog icon" height=18px class=filter-icon> blog</a></li><li role=none class=menu-item><a role=menuitem href=/about/><img src=/img/profile.svg alt="about page icon" height=18px class=filter-icon> about</a></li><li role=none class=menu-item><a role=menuitem href=/coffee/><img src=/img/coffee.svg alt="coffee icon" height=18px class=filter-icon> buy me coffee</a></li><li role=none class=menu-item><a role=menuitem href=/bookshelf/><img src=/img/book.svg alt="bookshelf icon" height=18px class=filter-icon> bookshelf</a></li><li role=none class=menu-item><a role=menuitem id=rss href=https://victoria.dev/index.xml rel=alternate type=application/rss+xml title="RSS for How I created custom desktop notifications using terminal and cron"><img src=/img/rss.svg alt="RSS icon" height=18px class=filter-icon> rss</a></li></ul></nav></header><main aria-role=main><div class=container><article class=h-entry><h1 class=title-header>How I created custom desktop notifications using terminal and cron</h1><p class=subtitle>How you can use tools your Linux system already has to create custom desktop notifications.</p><span><a class="tag button" href=/tags/terminal/>terminal
</a>&nbsp;
<a class="tag button" href=/tags/linux/>linux
</a>&nbsp;</span><p class=metadata id=date><time><a class="u-url dt-published" href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/>February 21, 2017</a></time>
<span class=dt-updated>&nbsp;
<em>Updated: Apr 8, 2021</em></span>
<span>☕️ ☕️&nbsp;6 min read</span></p></p><div class=page-separator><hr></div><div class="markdown e-content"><p>In my last post I talked about moving from Windows 10 to running i3 on Linux, built up from Debian Base System. Among other things, this change has taught me about the benefits of using basic tools and running a minimal, lightweight system. You can achieve a lot of functionality with just command line tools and simple utilities. One example I&rsquo;d like to illustrate in this post is setting up desktop notifications.</p><p>I use <a href=https://dunst-project.org/>dunst</a> for desktop notifications. It&rsquo;s a simple, lightweight tool that is easy to configure, doesn&rsquo;t have many dependencies, and can be used across various distributions.</p><h2 id=battery-statuslow-battery-notification class=anchor-link><a href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/#battery-statuslow-battery-notification>Battery status/low battery notification</a></h2><p>I was looking for a simple, versatile set up to create notifications for my battery status without having to rely on separate, standalone GUI apps or services. In my search I came across a simple one-line cron task that seemed to be the perfect fit. I adapted it to my purpose and it looks like this:</p><pre><code class=language-conf data-lang=conf># m h  dom mon dow   command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &lt; 20) print }' | xargs -ri env DISPLAY=:0 notify-send -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nBattery low!&quot;
</code></pre><blockquote><p><em>Psst&mldr; <a href=https://crontab.guru/>here&rsquo;s a great tool</a> for formatting your crontab times.</em></p></blockquote><p>There&rsquo;s a lot going on here, so let&rsquo;s break it down:
<code>*/5 * * * *</code>
Every five minutes, do the following.</p><p><code>acpi --battery</code>
Execute <code>acpi</code> and show battery information, which on its own returns something akin to:
<code>Battery 0: Discharging, 65%, 03:01:27 remaining</code></p><p>Pretty straightforward so far. At any point you could input <code>acpi --battery</code> in a terminal and receive the status output. Today&rsquo;s post, however, is about receiving this information passively in a desktop notification. So, moving on:</p><p><code>| awk -F, '/Discharging/ { if (int($2) &lt; 20) print }'</code>
Pipe (<code>|</code>) the result of the previous command to <code>awk</code>. (If you don&rsquo;t know what pipe does, here&rsquo;s <a href=http://superuser.com/questions/756158/what-does-the-linux-pipe-symbol-do>an answer from superuser.com</a> that explains it pretty well, I think.) <code>awk</code> can do a lot of things, but in this case, we&rsquo;re using it to examine the status of our battery. Let&rsquo;s zoom in on the <code>awk</code> command:</p><p><code>awk -F, '/Discharging/ { if (int($2) &lt; 20) print }'</code>
Basically, we&rsquo;re saying, &ldquo;Hey, awk, look at that input you just got and try to find the word &ldquo;discharging,&rdquo; then look to see if the number after the first comma is less than 20. If so, print the whole input.&rdquo;</p><p><code>| xargs -ri</code>
Pipe the result of the previous command to <code>xargs</code>, which takes it as its input and does more stuff with it. <code>-ri</code> is equivalent to <code>-r</code> (run the next command only if it receives arguments) and <code>-i</code> (look for &ldquo;{}&rdquo; and replace it with the input). So in this example, xargs serves as our gatekeeper and messenger for the next command.</p><p><code>env DISPLAY=:0</code>
Run the following utility in the specified display, in this case, the first display of the local machine.</p><p><code>notify-send -u critical -i "/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png" -t 3000 "{}\nLow battery!"</code>
Shows a desktop notification with <code>-u critical</code> (critical urgency), <code>-i</code> (the specified icon), <code>-t 3000</code> (display time/expires after 3000 milliseconds), and finally <code>{}</code> (the output of awk, replaced by xargs).</p><p>Not bad for a one-liner! I made a few modifications for different states of my battery. Here they all are in my crontab:</p><pre><code class=language-conf data-lang=conf># m h  dom mon dow   command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if ( (int($2) &lt; 30) &amp;&amp; (int($2) &gt; 15) ) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-low.png&quot; -t 3000 &quot;{}\nBattery low!&quot;
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &lt; 15) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nSeriously, plug me in.&quot;
*/60 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &gt; 30) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok.png&quot; &quot;{}&quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok-charging.png&quot; &quot;{}&quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { if (int($2) == 100) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-full-charging.png&quot; &quot;Fully charged.&quot;
</code></pre><p>By the way, you can open your crontab in the editor of your choice by accessing it as root from the <code>/var/spool/cron/crontabs/</code> directory. It&rsquo;s generally best practice however to make changes to your crontab with the command <code>crontab -e</code>.</p><p>You can see that each notification makes use of the <code>{}</code> placeholder that tells xargs to put its input there - except for the last one. This is interesting because in this case, we&rsquo;re only using <code>xargs -ri</code> as a kind of switch to present the notification. The actual information that was the input for xargs is not needed in the output in order to create a notification.</p><h2 id=additional-notifications-with-command-line-tools class=anchor-link><a href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/#additional-notifications-with-command-line-tools>Additional notifications with command line tools</a></h2><p>With cron and just a few combinations of simple command line tools, you can create interesting and useful notifications. Consider the following:</p><h3 id=periodically-check-your-dhcp-address class=anchor-link><a href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/#periodically-check-your-dhcp-address>Periodically check your dhcp address</a></h3><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>*/60 * * * * journalctl <span class=p>|</span> awk -F: <span class=s1>&#39;/dhcp/ &amp;&amp; /address/ { print $5 }&#39;</span> <span class=p>|</span> tail -1 <span class=p>|</span> xargs -ri env <span class=nv>DISPLAY</span><span class=o>=</span>:0 notify-send -a <span class=s2>&#34;dhcp address&#34;</span> -u normal <span class=s2>&#34;{}&#34;</span>
</code></pre></div><p>Which does the following:
<code>*/60 * * * *</code>
Every 60 minutes.</p><p><code>journalctl</code>
Take the contents of your system log.</p><p><code>| tail -1'/dhcp/ && /address/ { print $5 }'</code>
Find logs containing both &ldquo;dhcp&rdquo; and &ldquo;address&rdquo; and output the 5th portion as separated by &ldquo;:&rdquo; (the time field counts).</p><p><code>| tail -1</code>
Take the last line of the output.</p><p><code>| xargs -ri env DISPLAY=:0 notify-send -a "dhcp address" -u normal "{}"</code>
Create the desktop notification including the output.</p><h3 id=periodically-display-the-time-and-date class=anchor-link><a href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/#periodically-display-the-time-and-date>Periodically display the time and date</a></h3><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>*/60 * * * * timedatectl status <span class=p>|</span> awk -F<span class=se>\n</span> <span class=s1>&#39;/Local time/ { print }&#39;</span> <span class=p>|</span> xargs -ri env <span class=nv>DISPLAY</span><span class=o>=</span>:0 notify-send -a <span class=s2>&#34;Current Time&#34;</span> -u normal <span class=s2>&#34;{}&#34;</span>
</code></pre></div><h3 id=system-log-activity class=anchor-link><a href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/#system-log-activity>System log activity</a></h3><p>You can also search your system logs (try <code>journalctl</code>) for any number of things using awk, enabling you to get periodic notifications of virtually any logged events.</p><h2 id=experiment class=anchor-link><a href=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/#experiment>Experiment</a></h2><p>As with all things, you are only limited by your imagination! I hope this post has given you some idea about the endless possibilities of these simple utilities. Thanks for reading!</p></div><a class=hidden href=https://brid.gy/publish/twitter></a><a class=hidden href=https://brid.gy/publish/mastodon></a><data class=p-bridgy-omit-link value=false></data></article><div id=up-container><a href=# id=up>&#709;</a></div><div class=page-separator><hr></div><div id=webmentions></div><div class=related><code class=language-sql data-lang=sql>SELECT TOP 3 * FROM Related;</code><ul role=menubar id=article-list><li role=none class=h-entry><p class="p-author h-card hidden">Victoria Drake</p><img class="u-photo hidden" alt="photo of the author" id=author-img src=/img/victoria_headshot.jpg>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/>Batch renaming images, including image resolution, with awk</a><p class=e-content>How to batch rename images with custom values using file, awk, and rename - in rainbow colors!</p><p class=metadata><a class="tag button" href=/tags/terminal/>terminal</a>
☕️
&nbsp;4 min read
<time class="hidden dt-published">2017-11-20 13:59:30 -0500 -0500</time></p></li><li role=none class=h-entry><p class="p-author h-card hidden">Victoria Drake</p><img class="u-photo hidden" alt="photo of the author" id=author-img src=/img/victoria_headshot.jpg>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/create-a-self-hosted-chat-service-with-your-own-matrix-server/>Create a self-hosted chat service with your own Matrix server</a><p class=e-content>A speed-run introduction to Matrix via Dendrite.</p><p class=metadata><a class="tag button" href=/tags/privacy/>privacy</a>
☕️ ☕️
&nbsp;6 min read
<time class="hidden dt-published">2021-02-15 01:38:07 -0500 -0500</time></p></li><li role=none class=h-entry><p class="p-author h-card hidden">Victoria Drake</p><img class="u-photo hidden" alt="photo of the author" id=author-img src=/img/victoria_headshot.jpg>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/deceptively-simple-search-and-replace-across-multiple-files/>Deceptively simple search-and-replace across multiple files</a><p class=e-content>How to interactively search-and-replace across many files with just two commands, thanks to Vim.</p><p class=metadata><a class="tag button" href=/tags/terminal/>terminal</a>
☕️
&nbsp;2 min read
<time class="hidden dt-published">2020-08-25 04:48:39 -0600 -0600</time></p></li></ul><div class=page-separator><p class=back-link><a href=/blog>&lt;&lt; Back to blog</a></p></div></div></div><footer class=container><div class="markdown bio h-card p-author"><strong><a href=https://victoria.dev/ class="u-url p-name">Victoria Drake</a></strong><figure class="profile title-avatar u-photo"><img src=/img/victoria_headshot.jpg alt="Victoria's headshot"></figure><p>Victoria Drake is a Director of Engineering in Washington, DC. She is a core maintainer and co-author for the Open Web Application Security Project (OWASP) Web Security Testing Guide. She earned the annual Top Contributor award three years in a row from the freeCodeCamp non-profit, and is a recognized Distinguished Author on the DEV.to developer platform. She writes about software development, cybersecurity, and building happy and productive technical teams.</p><p><a href=/about>about</a> - <a href=mailto:hello@victoria.dev>email</a> - <a href=https://github.com/victoriadrake>github</a> - <a href=https://twitter.com/victoriadotdev>twitter</a> - <a href=https://www.linkedin.com/in/victoriadotdev/>linkedin</a></p></div></footer></main><script src=/js/webmention.min.js data-wordcount=42 async></script><nav aria-label="Victoria.dev menu for mobile" id=menu-mobile><ul role=menubar><li role=none class=menu-item><a role=menuitem href=/><img src=/img/bookmark.svg alt="home page icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/blog/><img src=/img/quote.svg alt="blog icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/about/><img src=/img/profile.svg alt="about page icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/coffee/><img src=/img/coffee.svg alt="coffee icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/bookshelf/><img src=/img/book.svg alt="bookshelf icon" height=18px class=filter-icon></a></li></ul></nav></body></html>