<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=description content="Victoria Drake is a senior software developer. She writes about software engineering, information security, and cybersecurity through education."><title>How I created custom desktop notifications using terminal and cron | victoria.dev</title><meta name=monetization content="$ilp.uphold.com/pBRfRwg2EJAe"><meta property="og:title" content="How I created custom desktop notifications using terminal and cron - victoria.dev"><meta property="og:type" content="website"><meta property="og:description" content="How you can use tools your Linux system already has to create custom desktop notifications."><meta property="og:url" content="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/"><meta property="og:site_name" content="victoria.dev"><meta property="og:image" content="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="How I created custom desktop notifications using terminal and cron"><meta name=twitter:image content="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif.png"><meta name=twitter:description content="How you can use tools your Linux system already has to create custom desktop notifications."><link rel="shortcut icon" href=/img/logo.ico><link rel=stylesheet href=/css/main.min.0b87a409f53cbfbdb4ec5068e3e24320e7f7f690331bd1b4d0b4a058c421dbad.css integrity="sha256-C4ekCfU8v7207FBo4+JDIOf39pAzG9G00LSgWMQh260=" media=screen></head><body><section id=main><div class=header><div class=toggle><input type=checkbox>
<span class=bar></span><span class=bar></span><span class=bar></span><div id=mobile-menu><span class=menu-item><a href=/>üë©üèª‚Äçüíª hi</a></span>
<span class=menu-item><a href=/blog/>üì∞ blog</a></span>
<span class=menu-item><a href=/about/>üìñ readme</a></span>
<span class=menu-item><a href=/coffee/><img src=/coffee/cup.png alt="coffee icon" height=16px> contribute</a></span></div></div><div id=menu><span class=menu-item><a href=/>üë©üèª‚Äçüíª hi</a></span>
<span class=menu-item><a href=/blog/>üì∞ blog</a></span>
<span class=menu-item><a href=/about/>üìñ readme</a></span>
<span class=menu-item><a href=/coffee/><img src=/coffee/cup.png alt="coffee icon" height=16px> contribute</a></span></div><div id=logo><img id=up alt="site logo" src=/img/logo.png></div></div><div class=container><div id=images><img src=https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif.png alt="cover image"></div><div class=markdown><h1>How I created custom desktop notifications using terminal and cron</h1><p class=subtitle>How you can use tools your Linux system already has to create custom desktop notifications.</p><p class=metadata id=date>February 21, 2017
‚òïÔ∏è‚òïÔ∏è&nbsp;
6 min read
&nbsp;
<a class=li-tag href=/tags/terminal/>terminal
</a>&nbsp;
<a class=li-tag href=/tags/linux/>linux
</a>&nbsp;</p></div><div class=page-separator><hr></div><div class=markdown><p>In my last post I talked about moving from Windows 10 to running i3 on Linux, built up from Debian Base System. Among other things, this change has taught me about the benefits of using basic tools and running a minimal, lightweight system. You can achieve a lot of functionality with just command line tools and simple utilities. One example I&rsquo;d like to illustrate in this post is setting up desktop notifications.</p><p>I use <a href=http://knopwob.org/dunst/>dunst</a> for desktop notifications. It&rsquo;s a simple, lightweight tool that is easy to configure, doesn&rsquo;t have many dependencies, and can be used across various distributions.</p><h1 id=battery-statuslow-battery-notification>Battery status/low battery notification</h1><p>I was looking for a simple, versatile set up to create notifications for my battery status without having to rely on separate, standalone GUI apps or services. In my search I came across a simple one-line cron task that seemed to be the perfect fit. I adapted it to my purpose and it looks like this:</p><pre><code class=language-conf data-lang=conf># m h  dom mon dow   command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &lt; 20) print }' | xargs -ri env DISPLAY=:0 notify-send -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nBattery low!&quot;
</code></pre><blockquote><p><em>Psst&mldr; <a href=https://crontab.guru/>here&rsquo;s a great tool</a> for formatting your crontab times.</em></p></blockquote><p>There&rsquo;s a lot going on here, so let&rsquo;s break it down:<br><code>*/5 * * * *</code><br>Every five minutes, do the following.</p><p><code>acpi --battery</code><br>Execute <code>acpi</code> and show battery information, which on its own returns something akin to:<br><code>Battery 0: Discharging, 65%, 03:01:27 remaining</code></p><p>Pretty straightforward so far. At any point you could input <code>acpi --battery</code> in a terminal and receive the status output. Today&rsquo;s post, however, is about receiving this information passively in a desktop notification. So, moving on:</p><p><code>| awk -F, '/Discharging/ { if (int($2) &lt; 20) print }'</code><br>Pipe (<code>|</code>) the result of the previous command to <code>awk</code>. (If you don&rsquo;t know what pipe does, here&rsquo;s <a href=http://superuser.com/questions/756158/what-does-the-linux-pipe-symbol-do>an answer from superuser.com</a> that explains it pretty well, I think.) <code>awk</code> can do a lot of things, but in this case, we&rsquo;re using it to examine the status of our battery. Let&rsquo;s zoom in on the <code>awk</code> command:</p><p><code>awk -F, '/Discharging/ { if (int($2) &lt; 20) print }'</code><br>Basically, we&rsquo;re saying, &ldquo;Hey, awk, look at that input you just got and try to find the word &ldquo;discharging,&rdquo; then look to see if the number after the first comma is less than 20. If so, print the whole input.&rdquo;</p><p><code>| xargs -ri</code><br>Pipe the result of the previous command to <code>xargs</code>, which takes it as its input and does more stuff with it. <code>-ri</code> is equivalent to <code>-r</code> (run the next command only if it receives arguments) and <code>-i</code> (look for &ldquo;{}&rdquo; and replace it with the input). So in this example, xargs serves as our gatekeeper and messenger for the next command.</p><p><code>env DISPLAY=:0</code><br>Run the following utility in the specified display, in this case, the first display of the local machine.</p><p><code>notify-send -u critical -i "/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png" -t 3000 "{}\nLow battery!"</code><br>Shows a desktop notification with <code>-u critical</code> (critical urgency), <code>-i</code> (the specified icon), <code>-t 3000</code> (display time/expires after 3000 milliseconds), and finally <code>{}</code> (the output of awk, replaced by xargs).</p><p>Not bad for a one-liner! I made a few modifications for different states of my battery. Here they all are in my crontab:</p><pre><code class=language-conf data-lang=conf># m h  dom mon dow   command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if ( (int($2) &lt; 30) &amp;&amp; (int($2) &gt; 15) ) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-low.png&quot; -t 3000 &quot;{}\nBattery low!&quot;
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &lt; 15) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u critical -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&quot; -t 3000 &quot;{}\nSeriously, plug me in.&quot;
*/60 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &gt; 30) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok.png&quot; &quot;{}&quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok-charging.png&quot; &quot;{}&quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { if (int($2) == 100) print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Battery status&quot; -u normal -i &quot;/usr/share/icons/Paper/16x16/status/xfce-battery-full-charging.png&quot; &quot;Fully charged.&quot;
</code></pre><p>By the way, you can open your crontab in the editor of your choice by accessing it as root from the <code>/var/spool/cron/crontabs/</code> directory. It&rsquo;s generally best practice however to make changes to your crontab with the command <code>crontab -e</code>.</p><p>You can see that each notification makes use of the <code>{}</code> placeholder that tells xargs to put its input there - except for the last one. This is interesting because in this case, we&rsquo;re only using <code>xargs -ri</code> as a kind of switch to present the notification. The actual information that was the input for xargs is not needed in the output in order to create a notification.</p><h1 id=additional-notifications-with-command-line-tools>Additional notifications with command line tools</h1><p>With cron and just a few combinations of simple command line tools, you can create interesting and useful notifications. Consider the following:</p><h2 id=periodically-check-your-dhcp-address>Periodically check your dhcp address</h2><pre><code>*/60 * * * * journalctl | awk -F: '/dhcp/ &amp;&amp; /address/ { print $5 }' | tail -1 | xargs -ri env DISPLAY=:0 notify-send -a &quot;dhcp address&quot; -u normal &quot;{}&quot;
</code></pre><p>Which does the following:<br><code>*/60 * * * *</code><br>Every 60 minutes.</p><p><code>journalctl</code><br>Take the contents of your system log.</p><p><code>| awk -F: '/dhcp/ && /address/ { print $5 }'</code><br>Find logs containing both &ldquo;dhcp&rdquo; and &ldquo;address&rdquo; and output the 5th portion as separated by &ldquo;:&rdquo; (the time field counts).</p><p><code>| tail -1</code><br>Take the last line of the output.</p><p><code>| xargs -ri env DISPLAY=:0 notify-send -a "dhcp address" -u normal "{}"</code><br>Create the desktop notification including the output.</p><h2 id=periodically-display-the-time-and-date>Periodically display the time and date</h2><pre><code>*/60 * * * * timedatectl status | awk -F\n '/Local time/ { print }' | xargs -ri env DISPLAY=:0 notify-send -a &quot;Current Time&quot; -u normal &quot;{}&quot;
</code></pre><h2 id=system-log-activity>System log activity</h2><p>You can also search your system logs (try <code>journalctl</code>) for any number of things using awk, enabling you to get periodic notifications of virtually any logged events.</p><h1 id=experiment>Experiment!</h1><p>As with all things, you are only limited by your imagination! I hope this post has given you some idea about the endless possibilities of these simple utilities. Thanks for reading!</p></div><div class=page-separator><hr></div><div class=related><div class="markdown highlight"><pre class=chroma><code class=language-sql data-lang=sql>SELECT TOP 3 * FROM Related;</code></pre></div><ul id=list-items><li><a class=li-link href=https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/>Batch renaming images, including image resolution, with awk</a><p class=li-brief>How to batch rename images with custom values using file, awk, and rename - in rainbow colors!</p><p class=metadata><a class=li-tag href=/tags/terminal/>terminal</a>
‚òïÔ∏è&nbsp;
4 min read</p></li><li><a class=li-link href=https://victoria.dev/blog/command-line-tricks-for-managing-your-messy-open-source-repository/>Command line tricks for managing your messy open source repository</a><p class=li-brief>A handy toolbox for the terminal to help open source maintainers make their projects sparkle.</p><p class=metadata><a class=li-tag href=/tags/terminal/>terminal</a>
‚òïÔ∏è&nbsp;
5 min read</p></li><li><a class=li-link href=https://victoria.dev/blog/bash-and-shell-expansions-lazy-list-making/>Bash and shell expansions: lazy list-making</a><p class=li-brief>A tour of brace expansion, shell parameter expansions, and playing with substrings in Bash.</p><p class=metadata><a class=li-tag href=/tags/terminal/>terminal</a>
‚òïÔ∏è&nbsp;
5 min read</p></li></ul><div class=page-separator><p class=back-link><a href=/blog>&lt;&lt; Back to blog</a></p></div></div></div><div class=container><footer><div class=markdown><figure class=profile><img src=/img/victoria_headshot.jpg alt="Victoria's headshot"></figure><p>Victoria Drake is a senior software developer in Washington, DC. She currently serves as a core maintainer and co-author for the Open Web Application Security Project (OWASP) Web Security Testing Guide. She earned the annual Top Contributor award two years in a row from the freeCodeCamp non-profit, and is a recognized Distinguished Author on the DEV.to developer platform. She writes about software development, cybersecurity, and information security awareness.</p><p><a href=/about>about</a> - <a href=mailto:hello@victoria.dev>email</a> - <a href=https://github.com/victoriadrake>github</a> - <a href=https://twitter.com/victoriadotdev>twitter</a> - <a href=https://www.linkedin.com/in/victoriadotdev/>linkedin</a></p></div></footer></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-98623582-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script>scrollTo=(element)=>{window.scroll({behavior:'smooth',left:0,top:element.offsetTop});}
document.getElementById("up").addEventListener('click',()=>{scrollTo(document.getElementById("main"));});</script></body></html>