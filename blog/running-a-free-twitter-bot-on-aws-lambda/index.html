<!doctype html><html lang=en-us><head><head><meta charset=utf-8><meta name=mobile-web-app-capable content="yes"><meta name=viewport content="width=device-width,initial-scale=1"><title>victoria.dev</title><meta name=monetization content="$ilp.uphold.com/pBRfRwg2EJAe"><link rel="shortcut icon" href=https://victoria.dev/favicon.ico><link rel=icon type=image/png href=https://victoria.dev/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://victoria.dev/favicon-16x16.png sizes=16x16><link rel=authorization_endpoint href=https://indieauth.com/auth><link rel=token_endpoint href=https://tokens.indieauth.com/token><link rel=me href=https://github.com/victoriadrake><link rel=me href=https://twitter.com/victoriadotdev><link rel=me href=https://mastodon.technology/@victoria><link rel=stylesheet href=https://victoria.dev/css/style.css crossorigin=anonymous media=screen><link rel=webmention href=https://webmention.io/victoria.dev/webmention><link rel=pingback href=https://webmention.io/victoria.dev/xmlrpc><meta property="og:url" content="https://victoria.dev/"><meta property="og:title" content="victoria.dev"><meta property="og:site_name" content="victoria.dev"><meta property="og:type" content="website"><meta name=twitter:title content="victoria.dev"></head></head><body><header role=banner><nav aria-label="Victoria.dev main menu" id=menu><ul role=menubar><li role=none class=menu-item><a role=menuitem href=/><img src=/icon/bookmark.svg alt="home page icon" height=18px class=filter-icon>&nbsp;hello</a></li><li role=none class=menu-item><a role=menuitem href=/blog/><img src=/icon/quote.svg alt="blog icon" height=18px class=filter-icon>&nbsp;blog</a></li><li role=none class=menu-item><a role=menuitem href=/about/><img src=/icon/profile.svg alt="about page icon" height=18px class=filter-icon>&nbsp;about</a></li><li role=none class=menu-item><a role=menuitem href=/bookshelf/><img src=/icon/book.svg alt="bookshelf icon" height=18px class=filter-icon>&nbsp;bookshelf</a></li></ul></nav><nav aria-label="Victoria.dev menu for mobile" id=menu-mobile><ul role=menubar><li role=none class=menu-item><a role=menuitem href=/><img src=/icon/bookmark.svg alt="home page icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/blog/><img src=/icon/quote.svg alt="blog icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/about/><img src=/icon/profile.svg alt="about page icon" height=18px class=filter-icon></a></li><li role=none class=menu-item><a role=menuitem href=/bookshelf/><img src=/icon/book.svg alt="bookshelf icon" height=18px class=filter-icon></a></li></ul></nav></header><main aria-role=main><div class=container><div id=cover-image><img class=u-photo src=https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/cover_lambda-doodle.png alt="cover image"></div><article class=h-entry><h1 class=p-name>Running a free Twitter bot on AWS Lambda</h1><p class=subtitle>How to save some time with automated link sharing on Twitter - for free!</p><span><a class="p-category tag button" href=/tags/aws/>aws
</a>&nbsp;
<a class="p-category tag button" href=/tags/go/>go
</a>&nbsp;</span>
<span rel=author class="p-author h-card"><img class="u-photo hidden" src=/img/victoria_headshot.jpg>
<span class="p-name hidden" rel=me>Victoria Drake</span></span><p class=metadata id=date><time class="hidden dt-published">2018-03-05 10:29:15 -0500 -0500</time>
<a class=u-url href=https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/>March 5, 2018</a>
<span class=dt-updated>&nbsp;<em>Updated: Jun 22, 2021</em></span>
<span>&nbsp;6 min read</span></p></p><div class=toc-dropdown><input type=checkbox id=toc-toggle>
<label for=toc-toggle id=toggle><p class=toc-title><span class=toc-dropdown-icon><img src=/img/anchor.svg height=18px class=filter-icon></span>
Jump to section...</p></label><nav id=TableOfContents><ul><li><a href=#is-lambda-right-for-you>Is Lambda right for you</a></li><li><a href=#write-a-lambda-function>Write a Lambda function</a></li><li><a href=#setting-up-aws-lambda>Setting up AWS Lambda</a><ul><li><a href=#1-create-your-function>1. Create your function</a></li><li><a href=#2-configure-your-function>2. Configure your function</a></li><li><a href=#3-upload-your-code>3. Upload your code</a></li><li><a href=#4-test-your-function>4. Test your function</a></li><li><a href=#5-set-up-cloudwatch-events>5. Set up CloudWatch Events</a></li></ul></li><li><a href=#watch-it-go>Watch it go</a></li></ul></nav></div><div class=page-separator><hr></div><div class="markdown e-content"><p>If you read <a href=/blog/about-time/>About time</a>, you&rsquo;ll know that I&rsquo;m a big believer in spending time now on building things that save time in the future. To this end I built a simple Twitter bot in Go that would occasionally post links to my articles and keep my account interesting even when I&rsquo;m too busy to use it. The tweets help drive traffic to my sites, and I don&rsquo;t have to lift a finger.</p><p>I ran the bot on an Amazon EC2 instance for about a month. My AWS usage has historically been pretty inexpensive (less than the price of a coffee in most of North America), so I was surprised when the little instance I was using racked up a bill 90% bigger than the month before. I don&rsquo;t think AWS is expensive, to be clear, but still&mldr; I&rsquo;m cheap. I want my Twitter bot, and I want it for less.</p><p>I&rsquo;d been meaning to explore AWS Lamda, and figured this was a good opportunity. Unlike an EC2 instance that is constantly running (and charging you for it), Lambda charges you per request and according to the duration of time your function takes to run. There&rsquo;s a free tier, too, and the first 1 million requests, plus a certain amount of compute time, are free. Roughly translated to running a Twitter bot that posts for you, say, twice a day, your monthly cost for using Lambda would total&mldr; carry the one&mldr; nothing. I&rsquo;ve been running my Lambda function for a couple weeks now, completely free.</p><p>When recently it came to me to take the reigns of the <a href=https://twitter.com/freeCodeCampTO>@freeCodeCampTO</a> Twitter, I decided to employ a similar strategy, and also use this opportunity to document the process for you, dear reader.</p><p>So if you&rsquo;re currently using a full-time running instance for a task that could be served by a cron job, this is the article for you. I&rsquo;ll cover how to write your function for Lambda, how to get it set up to run automatically, and as a sweet little bonus, a handy bash script that updates your function from the command line whenever you need to make a change. Let&rsquo;s do it!</p><h2 id=is-lambda-right-for-you>Is Lambda right for you</h2><p>When I wrote the code for my Twitter bot in Go, I intended to have it run on an AWS instance and borrowed heavily from <a href=https://github.com/campoy/justforfunc/tree/master/14-twitterbot>Francesc&rsquo;s awesome Just for Func episode</a>. Some time later I modified it to randomly choose an article from my RSS feeds and tweet the link, twice a day. I wanted to do something similar for the @freeCodeCampTO bot, and have it tweet an inspiring quote about programming every morning.</p><p>This is a good use case for Lambda because:</p><ul><li>The program should execute once</li><li>It runs on a regular schedule, using time as a trigger</li><li>It doesn&rsquo;t need to run constantly</li></ul><p>The important thing to keep in mind is that Lambda runs a function once in response to an event that you define. The most widely applicable trigger is a simple cron expression, but there are many other trigger events you can hook up. You can get an overview <a href=https://aws.amazon.com/lambda/>here</a>.</p><h2 id=write-a-lambda-function>Write a Lambda function</h2><p>I found this really straightforward to do in Go. First, grab the <a href=https://github.com/aws/aws-lambda-go>aws-lambda-go</a> library:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>go get github.com/aws/aws-lambda-go/lambda
</code></pre></div><p>Then make this your <code>func main()</code>:</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
 <span class=nx>lambda</span><span class=p>.</span><span class=nf>Start</span><span class=p>(</span><span class=nx>tweetFeed</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>Where <code>tweetFeed</code> is the name of the function that makes everything happen. While I won&rsquo;t go into writing the whole Twitter bot here, you can view my code <a href=https://gist.github.com/victoriadrake/7859dab68df87e28f40d6715d08383c7>on GitHub</a>.</p><h2 id=setting-up-aws-lambda>Setting up AWS Lambda</h2><p>I&rsquo;m assuming you already have an AWS account. If not, first things first here: <a href=https://aws.amazon.com/free>https://aws.amazon.com/free</a></p><h3 id=1-create-your-function>1. Create your function</h3><p>Find AWS Lambda in the list of services, then look for this shiny button:</p><p><img src=lambda-01.png#screenshot alt="Create function"></p><p>We&rsquo;re going to author a function from scratch. Name your function, then under <strong>Runtime</strong> choose &ldquo;Go 1.x&rdquo;.</p><p>Under <strong>Role name</strong> write any name you like. It&rsquo;s a required field but irrelevant for this use case.</p><p>Click <strong>Create function.</strong></p><p><img src=lambda-02.png#screenshot alt="Author from scratch"></p><h3 id=2-configure-your-function>2. Configure your function</h3><p>You&rsquo;ll see a screen for configuring your new function. Under <strong>Handler</strong> enter the name of your Go program.</p><p><img src=lambda-03.png#screenshot alt="Configure your function"></p><p>If you scroll down, you&rsquo;ll see a spot to enter environment variables. This is a great place to enter the Twitter API tokens and secrets, using the variable names that your program expects. The AWS Lambda function will create the environment for you using the variables you provide here.</p><p><img src=lambda-04.png#screenshot alt="Environment variables"></p><p>No further settings are necessary for this use case. Click <strong>Save</strong> at the top of the page.</p><h3 id=3-upload-your-code>3. Upload your code</h3><p>You can upload your function code as a zip file on the configuration screen. Since we&rsquo;re using Go, you&rsquo;ll want to <code>go build</code> first, then zip the resulting executable before uploading that to Lambda.</p><p>&mldr;Of course I&rsquo;m not going to do that manually every time I want to tweak my function. That&rsquo;s what <code>awscli</code> and this bash script is for!</p><p><code>update.sh</code></p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>go build <span class=o>&amp;&amp;</span> <span class=se>\
</span><span class=se></span>zip fcc-tweet.zip fcc-tweet <span class=o>&amp;&amp;</span> <span class=se>\
</span><span class=se></span>rm fcc-tweet <span class=o>&amp;&amp;</span> <span class=se>\
</span><span class=se></span>aws lambda update-function-code --function-name fcc-tweet --zip-file fileb://fcc-tweet.zip <span class=o>&amp;&amp;</span> <span class=se>\
</span><span class=se></span>rm fcc-tweet.zip
</code></pre></div><p>Now whenever I make a tweak, I just run <code>bash update.sh</code>.</p><p>If you&rsquo;re not already using <a href=https://aws.amazon.com/cli/>AWS Command Line Interface</a>, do <code>pip install awscli</code> and thank me later. Find instructions for getting set up and configured in a few minutes <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html>here</a> under <strong>Quick Configuration</strong>.</p><h3 id=4-test-your-function>4. Test your function</h3><p>Wanna see it go? Of course you do! Click &ldquo;Configure test events&rdquo; in the dropdown at the top.</p><p><img src=lambda-05.png#screenshot alt="Configure test events"></p><p>Since you&rsquo;ll use a time-based trigger for this function, you don&rsquo;t need to enter any code to define test events in the popup window. Simply write any name under <strong>Event name</strong> and empty the JSON in the field below. Then click <strong>Create</strong>.</p><p><img src=lambda-06.png#screenshot alt="Configuring an empty test event"></p><p>Click <strong>Test</strong> at the top of the page, and if everything is working correctly you should see&mldr;</p><p><img src=lambda-07.png#screenshot alt="Test success notification"></p><h3 id=5-set-up-cloudwatch-events>5. Set up CloudWatch Events</h3><p>To run our function as we would a cron job - as a regularly scheduled time-based event - we&rsquo;ll use CloudWatch. Click <strong>CloudWatch Events</strong> in the <strong>Designer</strong> sidebar.</p><p><img src=lambda-08.png#screenshot alt="CloudWatch Events trigger"></p><p>Under <strong>Configure triggers</strong>, you&rsquo;ll create a new rule. Choose a descriptive name for your rule without spaces or punctuation, and ensure <strong>Schedule expression</strong> is selected. Then input the time you want your program to run as a <em>rate expression</em>, or cron expression.</p><p>A cron expression looks like this: <code>cron(0 12 * * ? *)</code></p><table><thead><tr><th>Minutes</th><th>Hours</th><th>Month</th><th>Day of week</th><th>Year</th><th>In English</th></tr></thead><tbody><tr><td>0</td><td>12</td><td><code>*</code></td><td>?</td><td><code>*</code></td><td>Run at noon (UTC) every day</td></tr></tbody></table><p>For more on how to write your cron expressions, read <a href=https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/ScheduledEvents.html>this.</a></p><p>See the <a href=https://victoria.dev/utc/>current time in UTC</a>.</p><p>If you want your program to run twice a day, say once at 10am and again at 3pm, you&rsquo;ll need to set two separate CloudWatch Events triggers and cron expression rules.</p><p>Click <strong>Add</strong>.</p><p><img src=lambda-09.png#screenshot alt="Set cron expression rule"></p><h2 id=watch-it-go>Watch it go</h2><p>That&rsquo;s all you need to get your Lambda function up and running! Now you can sit back, relax, and do more important things than share your RSS links on Twitter.</p></div><a class=hidden href=https://brid.gy/publish/twitter></a><a class=hidden href=https://brid.gy/publish/mastodon></a><data class=p-bridgy-omit-link value=false></data></article><div id=up-container><a href=# id=up>v</a></div><hr><div id=webmentions></div><div class=related><code class=language-sql data-lang=sql>SELECT TOP 3 * FROM Related;</code><ul role=menubar id=article-list><li role=none class=h-entry><a rel=author class="p-author h-card hidden" href=https://victoria.dev/>Victoria Drake</a>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/>Why I'm automatically deleting my old tweets using AWS Lambda</a><p class="p-summary e-content">From now on, my tweets are ephemeral. Here’s why I’m deleting all my old tweets, and the AWS Lambda function I’m using to do all this for free.</p><p class=metadata><a class="p-category tag button" href=https://victoria.dev/tags/life/>life</a>
&nbsp;7 min read
<time class="hidden dt-published">2018-04-12 10:51:15 -0500 -0500</time></p></li><li role=none class=h-entry><a rel=author class="p-author h-card hidden" href=https://victoria.dev/>Victoria Drake</a>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/create-a-self-hosted-chat-service-with-your-own-matrix-server/>Create a self-hosted chat service with your own Matrix server</a><p class="p-summary e-content">A speed-run introduction to Matrix via Dendrite.</p><p class=metadata><a class="p-category tag button" href=https://victoria.dev/tags/privacy/>privacy</a>
&nbsp;6 min read
<time class="hidden dt-published">2021-02-15 01:38:07 -0500 -0500</time></p></li><li role=none class=h-entry><a rel=author class="p-author h-card hidden" href=https://victoria.dev/>Victoria Drake</a>
<a role=menuitem class="article-link u-url p-name" href=https://victoria.dev/blog/build-your-own-serverless-subscriber-list-with-go-and-aws/>Build your own serverless subscriber list with Go and AWS</a><p class="p-summary e-content">How to build your own newsletter list with DynamoDB and SES email sign up confirmations.</p><p class=metadata><a class="p-category tag button" href=https://victoria.dev/tags/api/>api</a>
&nbsp;7 min read
<time class="hidden dt-published">2020-11-10 04:52:50 -0500 -0500</time></p></li></ul><div class=page-separator><p class=back-link><a href=/blog>&lt;&lt; Back to blog</a></p></div></div></div></main><footer><div class="h-card row bio" rel=author><div class=markdown id=card><figure class=profile><img class=u-photo alt="Victoria Drake" src=/img/victoria_headshot.jpg></figure><h1 class=p-name>Victoria Drake</h1></address><p class=p-note><p>Victoria Drake is a Director of Engineering in Washington, DC. She is a core maintainer and co-author for the Open Web Application Security Project (OWASP) Web Security Testing Guide. She earned the annual Top Contributor award three years in a row from the freeCodeCamp non-profit, and was recognized two years in a row as a Distinguished Author on the DEV.to developer platform. She writes and educates programmers and business leaders about cybersecurity, software development, and building happy and productive technical teams.</p><p><a href=/about>about</a> - <a href=/contact>contact</a> - <a href=https://github.com/victoriadrake>github</a> - <a href=https://twitter.com/victoriadotdev>twitter</a> - <a href=https://www.linkedin.com/in/victoriadotdev/>linkedin</a></p></p></div></div></footer><script src=/js/webmention.min.js data-wordcount=100 async></script></body></html>